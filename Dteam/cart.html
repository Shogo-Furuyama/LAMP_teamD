<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="./css/login.css" rel="stylesheet">
  <link href="./css/cart.css" rel="stylesheet">
  <link href="./css/footer.css" rel="stylesheet">
  <link href="./css/bootstrap.min.css" rel="stylesheet">
  <style>
    .nav_input {
      width: 40%;

      >* {
        display: flex;

        >* {
          border: none;
          background: none;
          outline: none;
          border: solid 0.01rem silver;
        }

        >input {
          padding-left: 10px;
          padding-block: 5px;
          width: 80%;
          border-right: 0;
          border-radius: 1rem 0 0 1rem;
        }

        >button {
          width: 20%;
          border-radius: 0 1rem 1rem 0;
          background-color: green;
          color: white;
        }

        >button:active {
          background-color: forestgreen;
          color: white;
        }
      }
    }



    .stepper {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 40px;
      margin-top: 20px;


      width: 70%;



    }

    .stepper-step {
      flex: 1;
      text-align: center;

      color: #333333;
      padding: 10px;
      border: solid 1px #009900;
      ;
      border-radius: 40px;
      background-color: #009900;
      ;
      color: aliceblue;


    }

    .stepper-step.active {
      color: #333333;
      color: aliceblue;
    }

    .stepper-line {
      flex: 1;
      height: 2px;
      background-color: #999999;
    }

    .stepper-line.active {
      background-color: #333333;
    }

    .popup-container {
      position: relative;
    }

    .popup {

      display: flex;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 600px;
      height: 400px;
      background-color: white;
      border: 1px solid black;
      padding: 20px;
      text-align: center;
      z-index: 2;

      justify-content: center;
      align-items: center;

    }


    .popup-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1;
      display: none;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      color: #000;
      text-decoration: none;
    }

    .close-btn:hover {
      color: #ff0000;
    }

    .d-flex {
      width: 20em;
    }

    .table {
      margin-top: 20px;
    }
    .payment-section{
      
    }
  </style>
</head>

<body>
  <header>
    <nav class="navbar navbar-expand-sm navbar-light  px-3 py-2">
      <a href="#" class="navbar-brand "><img src="./img/logo1.png"
          style="display: flex; height: 4rem; width: auto;" /></a>

      <form class="nav_input">
        <div>
          <input type="search" placeholder="キーワードを入力" aria-label="Search">
          <button type="submit">検索</button>
        </div>
      </form>
      <div class="collapse navbar-collapse justify-content-end" id="navmenu">
        <div class="navbar-nav nav_a_style">
          <a class="nav-item nav-link" href="#">サービス概要</a>
          <a class="nav-item nav-link" href="#">新規登録</a>
          <a class="nav-item nav-link" href="#">ログイン</a>
          <!--<a class="nav-item nav-link active disabled" href="#">ログイン</a>-->
        </div>
      </div>
    </nav>
  </header>
  <main>
    <div class="stepper">
      <div class="stepper-step active">ショッピングカート</div>
      <div class="stepper-line active"></div>
      <div class="stepper-step">支払いと配送方法</div>
      <div class="stepper-line"></div>
      <div class="stepper-step">注文確認</div>
    </div>

    <div class="display1">
      <div class="basket">


        <i class="bi bi-cart4"></i>
        <h2>ショッピングカート</h2>


        <div class="basket-labels">
          <ul>
            <li class="item item-heading">商品</li>
            <li class="price">価格</li>
            <li class="quantity">個数</li>
            <li class="subtotal">小計</li>
          </ul>
        </div>
        <div class="basket-product" id="bp_0">
          <div class="item">
            <div class="product-image">
              <img src="./img/book1.jpg" alt="Placholder Image 2" class="product-frame">
            </div>
            <div class="product-details">
              <h5><strong>はらぺこあおむし</strong></h5>
              <p>著書:太宰治</p>
              <p>在庫あり</p>
            </div>
          </div>
          <div class="price">240</div>
          <div class="quantity">
            <input type="number" value="4" min="1" class="quantity-field" onchange="updateSubtotal(this)">
          </div>
          <div class="subtotal">960</div>
          <div class="remove">
            <button class="button" onclick="removeProduct(0)">消去</button>
          </div>
        </div>
        <div class="basket-product" id="bp_1">
          <div class="item">
            <div class="product-image">
              <img src="./img/book2.jpg" alt="Placholder Image 2" class="product-frame">
            </div>
            <div class="product-details">
              <h5><strong>人間失格</strong></h5>
              <p>著書:太宰治</p>
              <p>在庫あり</p>
            </div>
          </div>
          <div class="price">480</div>
          <div class="quantity">
            <input type="number" value="1" min="1" class="quantity-field" onchange="updateSubtotal(this)">
          </div>
          <div class="subtotal">480</div>
          <div class="remove">
            <button class="button" onclick="removeProduct(1)">消去</button>
          </div>

        </div>
      </div>
      <div id="cart-empty-message" style="display: none;">
        現在カートの中身には商品が入っておりません。またご利用お待ちしております。<br>
        <a href="#">トップページはこちら</a>
      </div>
    </div>

    <div class="display2 " style="display: none;">
      <div class="" style="width: 70%; float: left;">
        <h4>お支払い方法の選択</h4>
 


        <div class="payment-section">
        <form  style="border: 1px solid#EEEEEE; border-radius: 5px;">
          <input type="radio" id="creditCard" name="paymentMethod" value="creditCard" checked="checked">
          <label for="creditCard">クレジットカード</label>
          <img src ="./img/logoCard_visa_v2.png" style="display: inline;width: 35px;height: auto;">
          <img src ="./img/logoCard_master.png" style="display: inline;width: 35px;height: auto;">
          <img src ="./img/logoCard_jcb2.png" style="display: inline;width: 35px;height: auto;"><br>
          <img src ="./img/PlusIcon._CB485933946_.gif" style="display: inline;width: 13px;height: auto;">
          <a href="#" onclick="openPopup()">クレジットカードまたはデビットカードを追加</a><br>
         



          <input type="radio" id="bankTransfer" name="paymentMethod" value="bankTransfer" >
          <label for="bankTransfer">コンビニ前払い</label><br>

          <input type="radio" id="cod" name="paymentMethod" value="cod">
          <label for="cod">PayPay</label><br>
          <a href="#">支払い方法に関する詳細</a><br>
        </form>
        </div>
       
          <h4>配送方法とお届け日時の選択</h4>
           
          <div class="delivery-section" style="border: 1px solid#EEEEEE; border-radius: 5px;" >
          <h6>配送方法</h6>
          <form>
            <input type="radio" id="delivery" name="deliveryMethod" checked="checked">
            <label for=" delivery">通常配達</label><br>
            <a href="#">配送方法に関する詳細</a><br>
          </form>
          <h6>お届け日時</h6>
          <form>
            <input type="radio" id="date_specification" name="deliveryDate" checked="checked">
            <label for=" date">日時指定</label><br>
            <input type="radio" id="date_no" name="deliveryDate">
            <label for=" date">指定なし</label><br>

          </form>
          </div>

       
        <div class="popup-overlay" id="popup-overlay">
          <div class="window">
            <div class="popup" id="popup">
              <h5>クレジットカードまたはデビットカード追加</h5>
              <form method="post" asp-controller="Home" asp-action="Login" novalidate>

                <table class="table ">

                  <tbody class="tableSize">

                    <tr class="align-middle">

                      <th>

                        カード番号<span class="span">*</span>

                      </th>

                      <td>

                        <div class="d-flex ">

                          <input type="text" name="id" id="id" class="card_number form-control" maxlength="4">

                          <div id="id_error"></div>

                          &nbsp;-

                          <input type="text" name="id" id="id" class="card_number form-control" maxlength="4">

                          <div id="id_error"></div>

                          &nbsp;-

                          <input type="text" name="id" id="id" class="card_number form-control" maxlength="4">

                          <div id="id_error"></div>

                          &nbsp;-

                          <input type="text" name="id" id="id" class="card_number form-control" maxlength="4">

                          <div id="id_error"></div>

                        </div>

                      </td>

                    </tr>

                    <tr class="align-middle">

                      <th>

                        クレジットカード<br>名義人<span class="span">*</span>

                      </th>

                      <td>

                        <input type="text" name="name" id="name" class="form-control">

                        <div id="pass_error"></div>

                      </td>

                    </tr>

                    <tr class="align-middle">

                      <th>

                        有効期限<span class="span">*</span>

                      </th>

                      <td>
                        <div class="dicide ">
                          <select name="month">

                            <option slot="month">--</option>

                            <option slot="month">01</option>

                            <option slot="month">02</option>

                            <option slot="month">03</option>

                            <option slot="month">04</option>

                            <option slot="month">05</option>

                            <option slot="month">06</option>

                            <option slot="month">07</option>

                            <option slot="month">08</option>

                            <option slot="month">09</option>

                            <option slot="month">11</option>

                            <option slot="month">12</option>

                          </select>

                          &nbsp;月

                          <select name="year">

                            <option slot="year">--</option>

                            <option slot="year">2023</option>

                            <option slot="year">2024</option>

                            <option slot="year">2025</option>

                            <option slot="year">2026</option>

                            <option slot="year">2027</option>

                            <option slot="year">2028</option>

                            <option slot="year">2029</option>

                            <option slot="year">2030</option>

                            <option slot="year">2031</option>

                            <option slot="year">2032</option>

                            <option slot="year">2033</option>

                            <option slot="year">2034</option>

                            <option slot="year">2035</option>

                            <option slot="year">2036</option>

                            <option slot="year">2037</option>

                            <option slot="year">2038</option>

                            <option slot="year">2039</option>

                            <option slot="year">2040</option>

                            <option slot="year">2041</option>

                            <option slot="year">2042</option>

                            <option slot="year">2043</option>

                          </select>

                          &nbsp;年
                        </div>
                      </td>

                  </tbody>

                </table>


              </form>

              <a href="#" onclick="closePopup()"><span class="close-btn">&times;</span></a>
            </div>
          </div>
        </div>


        <script>
          function openPopup() {
            var overlay = document.getElementById('popup-overlay');
            var popup = document.getElementById('popup');
            overlay.style.display = 'block';
            popup.style.display = 'block';
          }

          function closePopup() {
            var overlay = document.getElementById('popup-overlay');
            var popup = document.getElementById('popup');
            overlay.style.display = 'none';
            popup.style.display = 'none';

          }
        </script>

      </div>
    </div>

    <div class="display3">
      <div class="order-confirmation" style="display: none;">
        <!-- order confirmation content -->
      </div>
    </div>


    </div>
    <aside>
      <div class="summary">
        <div class="summary-total-items"><span class="total-items"></span>
          <h5>
            <font color="#333333"> お支払い金額</font>
          </h5>
        </div>
        <div class="summary-subtotal">
          <div class="subtotal-title">商品小計 2点</div>
          <div class="subtotal-value final-value" id="basket-subtotal">1440</div>

        </div>

        <div class="summary-total">
          <div class="total-title">合計金額(税込)</div>
          <div class="total-value final-value" id="basket-total">1440</div>
        </div>
        <div class="summary-checkout">
          <button class="checkout-cta onclick=proceedToPaymentDelivery()" id="nextButton">次へ進む</button>
        </div>

      </div>
    </aside>

    <script>


      // 初期の小計を計算して表示する関数
      function calculateSubtotal() {
        var productRows = document.getElementsByClassName("basket-product");
        var subtotal = 0;

        for (var i = 0; i < productRows.length; i++) {
          var quantityField = productRows[i].getElementsByClassName("quantity-field")[0];
          var price = productRows[i].getElementsByClassName("price")[0].innerText;
          var subtotalField = productRows[i].getElementsByClassName("subtotal")[0];

          var quantity = parseInt(quantityField.value);
          var productSubtotal = quantity * parseInt(price);
          subtotal += productSubtotal;

          subtotalField.innerText = productSubtotal;
        }

        var subtotalValue = document.getElementById("basket-subtotal");
        var totalValue = document.getElementById("basket-total");

        subtotalValue.innerText = subtotal;
        totalValue.innerText = subtotal;
      }

      // 商品の個数が変更された時に小計を更新する関数
      function updateSubtotal(input) {
        var quantity = parseInt(input.value);
        var price = parseInt(input.parentNode.parentNode.getElementsByClassName("price")[0].innerText);
        var subtotal = quantity * price;

        input.parentNode.parentNode.getElementsByClassName("subtotal")[0].innerText = subtotal;

        calculateSubtotal();
      }

      // 商品を削除する関数
      function removeProduct(index) {
        document.getElementById("bp_" + index).remove();



        calculateSubtotal();
        // カートの中身をチェック
        checkCartEmpty();
      }

      // 初期の小計を計算して表示する
      calculateSubtotal();


      // ステップごとの表示切り替え
      const stepperSteps = document.querySelectorAll('.stepper-step');
      const stepperLines = document.querySelectorAll('.stepper-line');
      const basket = document.querySelector('.basket');
      const paymentDeliveryMethod = document.querySelector('.display2');
      const orderConfirmation = document.querySelector('.order-confirmation');
      const display1 = document.querySelector('.display1');
      let currentStep = 0;

      const steps = [display1, paymentDeliveryMethod, orderConfirmation];

      const nextButton = document.getElementById('nextButton');
      nextButton.addEventListener('click', () => {
        // 現在のステップを非表示にする
        steps[currentStep].style.display = 'none';
        stepperSteps[currentStep].classList.remove('active');
        currentStep++;
        if (currentStep >= steps.length) {
          currentStep = 0; // 最後のステップの次は最初に戻る
        }
        steps[currentStep].style.display = 'block';
        stepperSteps[currentStep].classList.add('active');
      });

      stepperSteps.forEach((step, index) => {
        step.addEventListener('click', () => {
          updateStepper(index);
        });
      });

      function updateStepper(activeStep) {
        currentStep = activeStep;
        steps.forEach((step, index) => {
          if (index === activeStep) {
            step.style.display = 'block';
            stepperSteps[index].classList.add('active');
          } else {
            step.style.display = 'none';
            stepperSteps[index].classList.remove('active');
          }
        });
      }

      function proceedToPaymentDelivery() {
        updateStepper(1); // 遷移先を支払いと配送方法に設定
        // 商品小計の更新
      }

      function checkCartEmpty() {
        var productRows = document.getElementsByClassName('basket-product');
        var cartEmptyMessage = document.getElementById('cart-empty-message');

        if (productRows.length === 0) {
          cartEmptyMessage.style.display = 'block';
          basket.style.display = 'none';
          paymentDeliveryMethod.style.display = 'none';
          orderConfirmation.style.display = 'none';
        } else {
          cartEmptyMessage.style.display = 'none';
          basket.style.display = 'block';
          paymentDeliveryMethod.style.display = 'none';
          orderConfirmation.style.display = 'none';
        }
      }




    </script>
  </main>
  <footer class="footer">
    <div class="footer_nav">
      <ul class="footer_navi">
        <li><a href="overview.html" class="text-decoration-none">サイト概要</a></li>
        <li><a href="#" class="text-decoration-none">お問い合わせ</a></li>
        <li><a href="#" class="text-decoration-none">プライバシーポリシー</a></li>
        <li><a href="terms_of_service.html" class="text-decoration-none">利用規約</a></li>
      </ul>
      <small class="text-start copyright">© WiZ株式会社 team-D Co. Ltd. 2023</small>
    </div>
  </footer>
</body>

</html>